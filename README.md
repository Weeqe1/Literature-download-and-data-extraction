# NFP-PDF-to-DB: çº³ç±³è§å…‰æ¢é’ˆæ–‡çŒ®æ•°æ®è‡ªåŠ¨åŒ–æå–ç³»ç»Ÿ

[![Python 3.10+](https://img.shields.io/badge/python-3.10+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

## ğŸ“– é¡¹ç›®æ¦‚è¿°

**NFP-PDF-to-DB** æ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„ç§‘å­¦æ–‡çŒ®æ•°æ®è‡ªåŠ¨åŒ–é‡‡é›†ä¸ç»“æ„åŒ–ä¿¡æ¯æå–ç³»ç»Ÿï¼Œä¸“ä¸ºçº³ç±³è§å…‰æ¢é’ˆï¼ˆNano Fluorescent Probes, NFPï¼‰é¢†åŸŸç ”ç©¶è®¾è®¡ã€‚è¯¥ç³»ç»Ÿå®ç°äº†ä»æ–‡çŒ®æ£€ç´¢ã€PDFä¸‹è½½åˆ°ç»“æ„åŒ–æ•°æ®æå–çš„å®Œæ•´æµæ°´çº¿ï¼Œé‡‡ç”¨**å¤šæ¨¡å‹é›†æˆï¼ˆMulti-Model Ensembleï¼‰**ç­–ç•¥æå‡ä¿¡æ¯æå–çš„å‡†ç¡®æ€§å’Œå¯é æ€§ã€‚

### æ ¸å¿ƒç‰¹æ€§

- **å¤šæºæ–‡çŒ®æ£€ç´¢**ï¼šé›†æˆ OpenAlexã€Web of Scienceã€Semantic Scholarã€PubMedã€arXivã€Crossref å…­å¤§å­¦æœ¯æ•°æ®åº“
- **æ™ºèƒ½ PDF ä¸‹è½½**ï¼šé€šè¿‡ Unpaywall å’Œå¼€æ”¾è·å–é“¾æ¥è‡ªåŠ¨è·å–å…¨æ–‡ PDF
- **å¤šæ¨¡å‹é›†æˆæå–**ï¼šè°ƒç”¨å¤šä¸ªå¤§è¯­è¨€æ¨¡å‹ï¼ˆOpenAI GPTã€Google Geminiã€DeepSeekã€Grokï¼‰å¹¶è¡Œæå–ï¼Œé€šè¿‡å…±è¯†æœºåˆ¶ç¡®ä¿æ•°æ®è´¨é‡
- **ç»“æ„åŒ–æ•°æ®è¾“å‡º**ï¼šæ ¹æ®é¢„å®šä¹‰ Schema æå–ææ–™ç»„æˆã€å…‰å­¦æ€§èƒ½ã€å·¥è‰ºå‚æ•°ç­‰å…³é”®å­—æ®µ
- **å¢é‡å¤„ç†æ¨¡å¼**ï¼šæ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼Œé¿å…é‡å¤å¤„ç†å·²é‡‡é›†çš„æ–‡çŒ®

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        NFP-PDF-to-DB Pipeline                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚  Stage 1: Harvest    â”‚     â”‚  Stage 2: Extraction â”‚                 â”‚
â”‚  â”‚  æ–‡çŒ®æ£€ç´¢ä¸ä¸‹è½½       â”‚ â”€â”€â–º â”‚  å¤šæ¨¡å‹ä¿¡æ¯æå–       â”‚                 â”‚
â”‚  â”‚  harvest_literature  â”‚     â”‚  run_etl_ensemble    â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚           â”‚                            â”‚                                â”‚
â”‚           â–¼                            â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚ â€¢ OpenAlex       â”‚         â”‚ â€¢ PDF æ–‡æœ¬è§£æ        â”‚                 â”‚
â”‚  â”‚ â€¢ Web of Science â”‚         â”‚ â€¢ å¤š LLM å¹¶è¡Œè°ƒç”¨     â”‚                 â”‚
â”‚  â”‚ â€¢ Semantic Scholarâ”‚        â”‚ â€¢ å…±è¯†å¼•æ“æ¯”å¯¹        â”‚                 â”‚
â”‚  â”‚ â€¢ PubMed         â”‚         â”‚ â€¢ èšç„¦é‡æå–          â”‚                 â”‚
â”‚  â”‚ â€¢ arXiv          â”‚         â”‚ â€¢ äººå·¥å®¡æ ¸æ ‡è®°        â”‚                 â”‚
â”‚  â”‚ â€¢ Crossref       â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚                                â”‚
â”‚           â”‚                            â–¼                                â”‚
â”‚           â–¼                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚  Structured JSON     â”‚                 â”‚
â”‚  â”‚ Excel + PDF æ–‡ä»¶ â”‚         â”‚  ç»“æ„åŒ–æ•°æ®è¾“å‡º       â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
NFP-PDF-to-DB/
â”œâ”€â”€ harvest_literature.py       # é˜¶æ®µä¸€ï¼šæ–‡çŒ®æ£€ç´¢ä¸ PDF ä¸‹è½½
â”œâ”€â”€ run_etl_ensemble.py         # é˜¶æ®µäºŒï¼šå¤šæ¨¡å‹é›†æˆä¿¡æ¯æå–
â”œâ”€â”€ requirements.txt            # Python ä¾èµ–
â”‚
â”œâ”€â”€ etl_ensemble/               # å¤šæ¨¡å‹æå–æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ pdf_parser.py           # PDF æ–‡æœ¬/è¡¨æ ¼è§£æ
â”‚   â”œâ”€â”€ llm_openai_client.py    # OpenAI API å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ llm_multi_client.py     # å¤šæ¨¡å‹ç»Ÿä¸€è°ƒç”¨æ¥å£
â”‚   â”œâ”€â”€ consensus_engine.py     # å¤šæ¨¡å‹è¾“å‡ºå…±è¯†å¼•æ“
â”‚   â”œâ”€â”€ focused_reextractor.py  # åˆ†æ­§å­—æ®µèšç„¦é‡æå–
â”‚   â””â”€â”€ human_review_manager.py # äººå·¥å®¡æ ¸ç®¡ç†
â”‚
â”œâ”€â”€ ml_dataset/                 # æœºå™¨å­¦ä¹ æ•°æ®é›†æ„å»º
â”‚   â””â”€â”€ prepare_ml_dataset.py   # æ•°æ®é¢„å¤„ç†ä¸ç‰¹å¾å·¥ç¨‹
â”‚
â”œâ”€â”€ configs/                    # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ harvest/                # æ–‡çŒ®æ£€ç´¢é…ç½®
â”‚   â”‚   â””â”€â”€ harvest_config.yml  # API å¯†é’¥ã€æœç´¢å‚æ•°
â”‚   â””â”€â”€ extraction/             # ä¿¡æ¯æå–é…ç½®
â”‚       â”œâ”€â”€ llm_backends.yml    # LLM åç«¯é…ç½®
â”‚       â”œâ”€â”€ schema.yml          # æ•°æ®æå–å­—æ®µå®šä¹‰
â”‚       â”œâ”€â”€ patterns.yml        # å­—æ®µåˆ«åä¸å•ä½è½¬æ¢
â”‚       â””â”€â”€ prompts/            # æç¤ºè¯æ¨¡æ¿
â”‚
â”œâ”€â”€ data/                       # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ pdfs/                   # è¾“å…¥ PDF æ–‡ä»¶
â”‚   â””â”€â”€ outputs/                # è¾“å‡ºç»“æœ
â”‚
â””â”€â”€ outputs/                    # é‡‡é›†è¾“å‡º
    â””â”€â”€ literature/             # ä¸‹è½½çš„ PDF ä¸å…ƒæ•°æ®
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.10+
- æ¨èä½¿ç”¨ Conda æˆ– venv åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ

### å®‰è£…ä¾èµ–

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-repo/nfp-pdf-to-db.git
cd nfp-pdf-to-db

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
conda create -n nfp_etl python=3.10
conda activate nfp_etl

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### é…ç½® API å¯†é’¥

1. **æ–‡çŒ®æ£€ç´¢é…ç½®** (`configs/harvest/harvest_config.yml`)ï¼š
   ```yaml
   api_keys:
     wos: "your_wos_api_key"
     semantic_scholar: "your_semantic_scholar_api_key"
     contact_email: "your_email@example.com"
   ```

2. **LLM æå–é…ç½®** (`configs/extraction/llm_backends.yml`)ï¼š
   ```yaml
   models:
     - id: openai_chatgpt
       provider: openai
       model_name: gpt-4o
       api_key_env: "your_openai_api_key"
   ```

---

## ğŸ“‹ ä½¿ç”¨æ–¹æ³•

### é˜¶æ®µä¸€ï¼šæ–‡çŒ®æ£€ç´¢ä¸ä¸‹è½½

```bash
python harvest_literature.py
```

**åŠŸèƒ½è¯´æ˜**ï¼š
- æ ¹æ®é…ç½®çš„å…³é”®è¯åœ¨å¤šä¸ªå­¦æœ¯æ•°æ®åº“ä¸­æ£€ç´¢æ–‡çŒ®
- è‡ªåŠ¨å»é‡å¹¶åˆå¹¶æ¥è‡ªä¸åŒæ•°æ®æºçš„ç»“æœ
- é€šè¿‡ Unpaywall è·å–å¼€æ”¾è·å– PDF
- è¾“å‡º Excel å…ƒæ•°æ®æ–‡ä»¶å’Œ PDF å…¨æ–‡

**é…ç½®å‚æ•°** (`configs/harvest/harvest_config.yml`)ï¼š

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `search.keywords` | å¸ƒå°”æ£€ç´¢è¡¨è¾¾å¼ | `("nano fluorescent probe") OR ...` |
| `search.year_from` | èµ·å§‹å¹´ä»½ | `2000` |
| `search.year_to` | ç»“æŸå¹´ä»½ | `2030` |
| `search.sources_order` | æ•°æ®æºä¼˜å…ˆçº§ | `[openalex, wos, ...]` |
| `output.base_dir` | è¾“å‡ºç›®å½• | `outputs/literature` |

### é˜¶æ®µäºŒï¼šå¤šæ¨¡å‹ä¿¡æ¯æå–

```bash
python run_etl_ensemble.py --pdf_dir data/pdfs --out_dir data/outputs/extraction
```

**å‘½ä»¤è¡Œå‚æ•°**ï¼š

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--pdf_dir` | PDF æ–‡ä»¶ç›®å½• | `data/pdfs` |
| `--out_dir` | è¾“å‡ºç›®å½• | `data/outputs/extraction` |
| `--cfg` | LLM é…ç½®æ–‡ä»¶ | `configs/extraction/llm_backends.yml` |
| `--schema` | Schema å®šä¹‰ | `configs/extraction/schema.yml` |
| `--prompt_file` | æç¤ºè¯æ¨¡æ¿ | `configs/extraction/prompts/paper_summarize.md` |

**æå–æµç¨‹**ï¼š

1. **PDF è§£æ**ï¼šä½¿ç”¨ pdfplumber/PyMuPDF æå–æ–‡æœ¬å†…å®¹
2. **å¤šæ¨¡å‹è°ƒç”¨**ï¼šå¹¶è¡Œè°ƒç”¨é…ç½®çš„æ‰€æœ‰ LLM è¿›è¡Œç»“æ„åŒ–æå–
3. **å…±è¯†æ¯”å¯¹**ï¼š
   - æ•°å€¼å‹å­—æ®µï¼šå®¹å·®æ¯”è¾ƒï¼ˆÂ±1% æˆ– Â±1.0ï¼‰
   - å­—ç¬¦ä¸²å­—æ®µï¼šå½’ä¸€åŒ–ç²¾ç¡®åŒ¹é…
4. **åˆ†æ­§å¤„ç†**ï¼šå¯¹ä¸ä¸€è‡´å­—æ®µè¿›è¡Œèšç„¦é‡æå–
5. **ç»“æœè¾“å‡º**ï¼šå…±è¯†æ•°æ®ä¿å­˜ä¸º JSONï¼Œä»æœ‰åˆ†æ­§åˆ™æ ‡è®°ä¸ºäººå·¥å®¡æ ¸

---

## ğŸ“Š æ•°æ® Schema

æå–çš„ç»“æ„åŒ–æ•°æ®åŒ…å«ä»¥ä¸‹å­—æ®µç±»åˆ«ï¼ˆè¯¦è§ `configs/extraction/schema.yml`ï¼‰ï¼š

### è®ºæ–‡å…ƒæ•°æ®
- `title`, `doi`, `year`, `journal`

### ææ–™ä¿¡æ¯
- `core_type` (QD, Perovskite, CD, UCNP, AIE-dot, P-dot, SiO2-dye)
- `composition_core`, `shell_type`, `core_size_nm`, `dopants`

### å…‰å­¦æ€§èƒ½
- `abs_peak_nm`, `emi_peak_nm`, `stokes_nm`
- `QY` (é‡å­äº§ç‡), `lifetime_ns`, `photobleach_t_half_min`

### å·¥è‰ºå‚æ•°
- `max_temp_C`, `hold_time_min`, `solvent_system`

### èƒ¶ä½“ç¯å¢ƒ
- `zeta_mV`, `hydrodynamic_diameter_nm`, `environment_pH`

---

## ğŸ”§ æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯ |
|------|------|
| PDF è§£æ | pdfplumber, PyMuPDF (fitz), Camelot |
| LLM æ¥å£ | OpenAI API (GPT-4), Google Gemini, DeepSeek |
| æ•°æ®å¤„ç† | pandas, numpy |
| é…ç½®ç®¡ç† | PyYAML |
| HTTP è¯·æ±‚ | requests, tenacity (é‡è¯•æœºåˆ¶) |

---

## ğŸ“ å¼•ç”¨

å¦‚æœæœ¬é¡¹ç›®å¯¹æ‚¨çš„ç ”ç©¶æœ‰æ‰€å¸®åŠ©ï¼Œè¯·è€ƒè™‘å¼•ç”¨ï¼š

```bibtex
@software{nfp_pdf_to_db,
  title = {NFP-PDF-to-DB: Automated Literature Data Extraction for Nano Fluorescent Probes},
  author = {Wang, Qi},
  year = {2024},
  url = {https://github.com/your-repo/nfp-pdf-to-db}
}
```

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

---

**è”ç³»æ–¹å¼**: wangqi@ahut.edu.cn
